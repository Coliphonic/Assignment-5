<html>

<head>

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>



<script>



// all our animation will go in here

$(document).ready(function(){



 var canvas = $("#myCanvas");

 var context = canvas.get(0).getContext("2d");


 var counter = 0;


 function animate(){


 counter = counter + .1;


 context.fillStyle = "rgb(0,0,0)";

 context.fillRect(0,0, canvas.width(), canvas.height());


 context.save();

 

 context.translate(100 + (200 * Math.cos(counter)), 100);

 context.rotate(Math.sin(counter));


 var scaler =  (Math.cos(counter/2)) + 1;

 context.scale(scaler, scaler);

 

 context.beginPath();

 context.moveTo(20, 20 + (100 * Math.sin(counter)));

 context.lineTo(0, 100);

 context.lineTo(150, 300);

 context.closePath();


 context.fillStyle = "rgb(255, 255, 0)";

 context.fill();


 context.strokeStyle = "rgb(255, 0, 0)";

 context.lineWidth = 6;

 context.stroke();


 context.restore();


 requestAnimationFrame(animate);

 }


 //animate();




 var Object  =  function(newX, newY, size, c, cR, a){

 this.x = newX;

 this.y = newY;

 this.w = size;

 this.counter = c;

 this.counterRate = cR;

 this.area = a;

 }


 var objs = new Array();


 for(var i=0; i<10; i++){

 var tmpX = Math.random() * canvas.width();

 var tmpY = Math.random() * canvas.height();

 var tmpSize = (Math.random() * 20) + 10;

 var tmpCounter = Math.random()*2;

 var tmpCounterRate = Math.random()*.2;

 var tmpArea = 200 * Math.random();

 objs.push( new Object(tmpX, tmpY, tmpSize, tmpCounter, tmpCounterRate, tmpArea)  );

 }

 var user = new Object(canvas.width()/2, canvas.height()/2, 20, 0, 0, 0);
 
 

 function animate2(){

 context.fillStyle = "rgb(0,0,0)";

 context.fillRect(0,0, canvas.width(), canvas.height()); 


 context.fillStyle = "rgb(100, 255, 0)";

 for(var i=0; i<objs.length; i++){
	 
	 if((user.x < (objs[i].x+objs[i].w)) || (user.x+user.x) > objs[i].x ){
//user and i overlaps
		 
 
}

else{
	
    objs[i].counter = objs[i].counter + objs[i].counterRate;
	
}

 //console.log(objs[i].area);

 context.save();

 context.translate( objs[i].area * Math.sin(objs[i].counter)  , 0);

 context.fillRect(objs[i].x, objs[i].y, objs[i].w, objs[i].w);
 
 

 context.restore();

 }

 context.fillRect(user[i].x, user[i].y, user[i].w, user[i].w);


 requestAnimationFrame(animate2);

 }

 animate2();

 $(window).keydown(function(e){
 	
	 console.log("keypressed!");
	 var keyCode = e.keyCode;
	 if (keyCode == 37) //left arrow
	 {
		 user.x -= 3;
	 }
	 else if (keyCode == 38){ //up arrow
	 	
		 user.y -= 3;
	 }
	 else if (keyCode == 39){ //right arrow
	 	user.x += 6
		
	 }
	 else if (keyCode == 40) { // down arrow
	 	user.x += 6
		
	 }
 });

$("#myCanvas").bind( "click", function(){
	
	var x = event.pageX;
	var y = event.pageY;
	console.log(x + " " + y)
	user.x = x - user.w/2;
	user.y = y - user.w/2;
	
});

});

</script>


</head>

<body>

<canvas id="myCanvas"  width="500" height="500" ></canvas>

</body>

</html>
